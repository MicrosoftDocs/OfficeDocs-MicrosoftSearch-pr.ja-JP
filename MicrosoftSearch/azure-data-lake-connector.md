---
title: Microsoft Search 用 Azure Data Lake connector
ms.author: monaray
author: monaray97
manager: shohara
ms.audience: Admin
ms.topic: article
ms.service: mssearch
localization_priority: Normal
search.appverid:
- BFB160
- MET150
- MOE150
description: Microsoft Search 用の Azure Data Lake Storage Gen2 connector をセットアップする
ms.openlocfilehash: 01fea60e91af5ba321ceb00578ea2b0745c9c394
ms.sourcegitcommit: be0c64845477127d73ee24dc727e4583ced3d0e6
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/22/2020
ms.locfileid: "48206934"
---
# <a name="azure-data-lake-storage-gen2-connector"></a><span data-ttu-id="08c3b-103">Azure Data Lake Storage Gen2 connector</span><span class="sxs-lookup"><span data-stu-id="08c3b-103">Azure Data Lake Storage Gen2 connector</span></span>

<span data-ttu-id="08c3b-104">Azure Data Lake Storage Gen2 コネクタを使用すると、組織内のユーザーは、 [Azure Blob ストレージ](https://docs.microsoft.com/azure/storage/blobs/storage-blobs-introduction) と [Azure Data lake Gen 2 のストレージ](https://docs.microsoft.com/azure/storage/blobs/data-lake-storage-introduction) アカウントに格納されているファイルを検索できます。</span><span class="sxs-lookup"><span data-stu-id="08c3b-104">With the Azure Data Lake Storage Gen2 connector, users in your organization can search for files stored in [Azure Blob Storage](https://docs.microsoft.com/azure/storage/blobs/storage-blobs-introduction) and [Azure Data Lake Gen 2 Storage](https://docs.microsoft.com/azure/storage/blobs/data-lake-storage-introduction) accounts.</span></span>

<span data-ttu-id="08c3b-105">この記事は、 [Microsoft 365](https://www.microsoft.com/microsoft-365) 管理者または Azure Data Lake Storage Gen2 connector を構成、実行、および監視するユーザーを対象としています。</span><span class="sxs-lookup"><span data-stu-id="08c3b-105">This article is for [Microsoft 365](https://www.microsoft.com/microsoft-365) administrators or anyone who configures, runs, and monitors an Azure Data Lake Storage Gen2 connector.</span></span> <span data-ttu-id="08c3b-106">コネクタの構成、機能、制限事項、およびトラブルシューティングの手法の概要を示します。</span><span class="sxs-lookup"><span data-stu-id="08c3b-106">It gives an overview of the connector configuration, capabilities, limitations, and troubleshooting techniques.</span></span> <span data-ttu-id="08c3b-107">この記事では、azure *ストレージ* を [azure Blob ストレージ](https://docs.microsoft.com/azure/storage/blobs/storage-blobs-introduction) と [Azure Data Lake Gen 2 ストレージ](https://docs.microsoft.com/azure/storage/blobs/data-lake-storage-introduction)の一般的な用語として使用します。</span><span class="sxs-lookup"><span data-stu-id="08c3b-107">In the article, we use *Azure Storage* as a generic term for [Azure Blob Storage](https://docs.microsoft.com/azure/storage/blobs/storage-blobs-introduction) and [Azure Data Lake Gen 2 Storage](https://docs.microsoft.com/azure/storage/blobs/data-lake-storage-introduction).</span></span>

## <a name="connect-to-a-data-source"></a><span data-ttu-id="08c3b-108">データソースへの接続</span><span class="sxs-lookup"><span data-stu-id="08c3b-108">Connect to a data source</span></span>
### <a name="primary-storage-connection-string"></a><span data-ttu-id="08c3b-109">プライマリストレージ接続文字列</span><span class="sxs-lookup"><span data-stu-id="08c3b-109">Primary storage connection string</span></span> 
<span data-ttu-id="08c3b-110">[ **認証と構成** ] 画面で、プライマリストレージ接続文字列を指定します。</span><span class="sxs-lookup"><span data-stu-id="08c3b-110">On the **Authentication and config** screen, provide the Primary Storage Connection String.</span></span> <span data-ttu-id="08c3b-111">この文字列は、ストレージアカウントへのアクセスを許可するために必要です。</span><span class="sxs-lookup"><span data-stu-id="08c3b-111">That string is required to allow access to your storage account.</span></span> <span data-ttu-id="08c3b-112">接続文字列を検索するには、 [azure ポータル](https://ms.portal.azure.com/#home) に移動して、関連する azure Storage アカウントの [ **キー** ] セクションに移動します。</span><span class="sxs-lookup"><span data-stu-id="08c3b-112">To find your connection string, go to the [Azure portal](https://ms.portal.azure.com/#home) and navigate to the **Keys** section of your relevant Azure Storage account.</span></span> <span data-ttu-id="08c3b-113">接続文字列をコピーして画面の適切なフィールドに貼り付けます。</span><span class="sxs-lookup"><span data-stu-id="08c3b-113">Copy and paste the connection string in the appropriate field on the screen.</span></span>

<span data-ttu-id="08c3b-114">**AccountKey** (プライマリストレージ接続文字列のパラメーター) を指定しない場合は、次の役割の Graph connector Service へのアクセス権を付与する必要があります。</span><span class="sxs-lookup"><span data-stu-id="08c3b-114">If you do not prefer to provide the **AccountKey** (a parameter in the primary storage connection string), you will need to grant access to our Graph Connectors Service for the following roles.</span></span> 
* <span data-ttu-id="08c3b-115">記憶域 Blob データリーダー</span><span class="sxs-lookup"><span data-stu-id="08c3b-115">Storage Blob Data Reader</span></span>
* <span data-ttu-id="08c3b-116">ストレージキューデータ寄稿者</span><span class="sxs-lookup"><span data-stu-id="08c3b-116">Storage Queue Data Contributor</span></span>
* <span data-ttu-id="08c3b-117">Storage Blob 委任者 (階層型ストレージの場合のみ)</span><span class="sxs-lookup"><span data-stu-id="08c3b-117">Storage Blob Delegator (only for hierarchical storage)</span></span>

<span data-ttu-id="08c3b-118">Azure ストレージアカウントの [ **アクセス制御** ] タブに移動し、次のアプリへのアクセス権を付与するための手順に従います。</span><span class="sxs-lookup"><span data-stu-id="08c3b-118">Navigate to the **Access Control** tab of your Azure Storage account, and follow the instructions there to grant access to the following app:</span></span>
* <span data-ttu-id="08c3b-119">**最初のパーティのアプリ ID:** 56c1da01-2127648f7-9355-af6d59d2766</span><span class="sxs-lookup"><span data-stu-id="08c3b-119">**First Party App ID:** 56c1da01-2129-48f7-9355-af6d59d42766</span></span>
* <span data-ttu-id="08c3b-120">**ファーストパーティのアプリ名:** Graph Connector サービス</span><span class="sxs-lookup"><span data-stu-id="08c3b-120">**First Party App Name:** Graph Connector Service</span></span>

### <a name="storage-account-and-queue-notifications-optional"></a><span data-ttu-id="08c3b-121">ストレージアカウントとキューの通知 (オプション)</span><span class="sxs-lookup"><span data-stu-id="08c3b-121">Storage account and queue notifications (Optional)</span></span>
<span data-ttu-id="08c3b-122">グラフコネクタサービスでリアルタイムでの変更の処理のサポートが今後追加される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="08c3b-122">Support to process changes in real time in the Graph Connectors Service might be added in the future.</span></span> <span data-ttu-id="08c3b-123">その場合は、キューに格納されている Azure ストレージの変更通知を監視します。</span><span class="sxs-lookup"><span data-stu-id="08c3b-123">In that case, we'll monitor Azure Storage change notifications stored in a queue.</span></span> <span data-ttu-id="08c3b-124">Azure ストレージアカウントと同じアカウントでキューを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="08c3b-124">You'll need to create a queue in the same account as your Azure Storage account.</span></span>

<span data-ttu-id="08c3b-125">キューを作成した後、[キュー] ページの [ **イベント** ] タブに移動して、 **イベントサブスクリプション**を構成します。</span><span class="sxs-lookup"><span data-stu-id="08c3b-125">After you create a queue, go to the **Events** tab on the queue page to configure **Event Subscription**.</span></span> <span data-ttu-id="08c3b-126">キューが受信するすべての Blob イベントを選択し、キューを Azure ストレージアカウントに接続します。</span><span class="sxs-lookup"><span data-stu-id="08c3b-126">Choose all the Blob events that the queue will receive, and connect the queue to the Azure Storage account.</span></span>

## <a name="manage-the-search-schema"></a><span data-ttu-id="08c3b-127">検索スキーマを管理する</span><span class="sxs-lookup"><span data-stu-id="08c3b-127">Manage the search schema</span></span>
<span data-ttu-id="08c3b-128">[ **スキーマの管理** ] 画面には、管理プロパティに関連付けられているスキーマ属性 (**クエリ**可能、 **検索**可能、および取得 **可能) を**変更するオプションがあります。</span><span class="sxs-lookup"><span data-stu-id="08c3b-128">On the **Manage Schema** screen, you have the option to change the schema attributes (**queryable**, **searchable**, and **retrievable**) associated with the managed properties.</span></span> <span data-ttu-id="08c3b-129">これらの管理プロパティの属性は、Azure データストレージアカウントからインデックスが作成されたデータです。</span><span class="sxs-lookup"><span data-stu-id="08c3b-129">These managed property attributes are data indexed from your Azure Data Storage account.</span></span>

## <a name="manage-search-permissions"></a><span data-ttu-id="08c3b-130">検索アクセス許可を管理する</span><span class="sxs-lookup"><span data-stu-id="08c3b-130">Manage search permissions</span></span>
### <a name="azure-data-lake-gen-2"></a><span data-ttu-id="08c3b-131">Azure Data Lake Gen 2</span><span class="sxs-lookup"><span data-stu-id="08c3b-131">Azure Data Lake Gen 2</span></span>
<span data-ttu-id="08c3b-132">[ **検索権限の管理** ] 画面では、 [Azure Data Lake Gen 2 ストレージ](https://docs.microsoft.com/azure/storage/blobs/data-lake-storage-introduction) アカウントからアクセス制御リスト (acl) を取り込みます。</span><span class="sxs-lookup"><span data-stu-id="08c3b-132">On the **Manage search permissions** screen, you can choose to ingest the Access Control Lists (ACLs) from your [Azure Data Lake Gen 2 Storage](https://docs.microsoft.com/azure/storage/blobs/data-lake-storage-introduction) account.</span></span> <span data-ttu-id="08c3b-133">これらの検索権限が設定されている場合、コンテンツを検索するサインインしている [Azure Active Directory](https://docs.microsoft.com/azure/active-directory/) ユーザーに割り当てられているアクセス許可に基づいて、検索コンテンツがトリミングされます。</span><span class="sxs-lookup"><span data-stu-id="08c3b-133">When these search permissions are set, search content is trimmed based on the permissions assigned to the signed-in [Azure Active Directory](https://docs.microsoft.com/azure/active-directory/) user searching the content.</span></span> <span data-ttu-id="08c3b-134">または、組織内のすべてのユーザーに対して、ストレージアカウントからインデックスが作成されたすべてのコンテンツを表示するように選択することもできます。</span><span class="sxs-lookup"><span data-stu-id="08c3b-134">Alternatively, you can choose to make all the content indexed from your storage account visible to everyone in your organization.</span></span> <span data-ttu-id="08c3b-135">この場合、組織内のすべてのユーザーがストレージアカウントのすべてのデータにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="08c3b-135">In this case, everyone in your organization will have access to all the data in your storage account.</span></span>

### <a name="azure-blob-storage"></a><span data-ttu-id="08c3b-136">Azure Blob Storage</span><span class="sxs-lookup"><span data-stu-id="08c3b-136">Azure Blob Storage</span></span>
<span data-ttu-id="08c3b-137">[Azure Blob ストレージ](https://docs.microsoft.com/azure/storage/blobs/storage-blobs-introduction)への接続の場合、構成されたソースからインデックスが作成されたすべてのコンテンツが組織内のすべてのユーザーに表示されます。</span><span class="sxs-lookup"><span data-stu-id="08c3b-137">For a connection to [Azure Blob Storage](https://docs.microsoft.com/azure/storage/blobs/storage-blobs-introduction), all the content indexed from the configured source is visible to everyone in your organization.</span></span> <span data-ttu-id="08c3b-138">アクセス制御リストは、Azure Blob ストレージの Blob レベルではサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="08c3b-138">Access control lists are not supported at Blob level in Azure Blob Storage.</span></span>

## <a name="set-the-refresh-schedule"></a><span data-ttu-id="08c3b-139">更新スケジュールを設定する</span><span class="sxs-lookup"><span data-stu-id="08c3b-139">Set the refresh schedule</span></span>
<span data-ttu-id="08c3b-140">[ **更新の設定** ] 画面で、増分クロールの間隔とフルクロールの間隔を設定できます。</span><span class="sxs-lookup"><span data-stu-id="08c3b-140">On the **Refresh Settings** screen, you can set the incremental crawl interval and the full crawl interval.</span></span> <span data-ttu-id="08c3b-141">Azure Data Lake Storage Gen2 コネクタの既定の間隔は、増分クロールの場合は15分、フルクロールの場合は1週間です。</span><span class="sxs-lookup"><span data-stu-id="08c3b-141">The default intervals for the Azure Data Lake Storage Gen2 connector are 15 minutes for an incremental crawl and one week for a full crawl.</span></span>

## <a name="limitations"></a><span data-ttu-id="08c3b-142">制限事項</span><span class="sxs-lookup"><span data-stu-id="08c3b-142">Limitations</span></span>
<span data-ttu-id="08c3b-143">Azure Data Lake Storage Gen2 source に対して、公開されている接続を再構成することはできません。また、その逆も同様です。</span><span class="sxs-lookup"><span data-stu-id="08c3b-143">A published connection for Azure Blob Storage cannot be reconfigured for Azure Data Lake Storage Gen2 source and vice-versa.</span></span> <span data-ttu-id="08c3b-144">このようなシナリオでは、新しい接続を構成することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="08c3b-144">In such scenarios, it is recommended to configure a new connection.</span></span>
